<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é ­é ¸ç™ŒåŒ–ç™‚æ°£çƒå¤§ä½œæˆ°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; overflow-x: hidden; }
        .balloon-float { transition: bottom 0.03s linear; }
        @keyframes ping {
            0% { transform: scale(1); opacity: 1; }
            75%, 100% { transform: scale(1.5); opacity: 0; }
        }
        .animate-ping-custom { animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite; }
    </style>
</head>
<body class="bg-slate-900 text-white min-h-screen">

    <header class="sticky top-0 z-50 bg-slate-800/90 border-b border-slate-700 p-4 shadow-lg backdrop-blur-sm">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold flex items-center gap-2 text-cyan-400">
                âœ¨ é ­é ¸ç™ŒåŒ–ç™‚æ°£çƒå¤§ä½œæˆ°
            </h1>
            <div id="stats-container" class="hidden flex gap-4 items-center">
                <div class="bg-slate-700 px-3 py-1 rounded-full text-yellow-400 font-mono flex items-center gap-2">
                    ğŸ† <span id="score-display">0</span>
                </div>
                <div id="lives-display" class="flex gap-1 text-rose-500 text-xl"></div>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto p-4 mt-4">
        <div id="game-menu" class="text-center py-20 bg-slate-800 rounded-3xl border border-slate-700">
            <div class="text-8xl mb-6">ğŸˆ</div>
            <h2 class="text-4xl font-black mb-4">è¡›æ•™çŸ¥è­˜æŒ‘æˆ°è³½</h2>
            <p class="text-slate-400 mb-10 max-w-md mx-auto">æ¸¬è©¦ä½ å°é ­é ¸ç™ŒåŒ–ç™‚çš„äº†è§£ï¼é»æ“Šæ°£çƒå›ç­”å•é¡Œï¼Œç­”å°å¾—åˆ†ï¼Œç­”éŒ¯æˆ–æ°£çƒé£„èµ°æœƒå¤±å»ç”Ÿå‘½å€¼ã€‚</p>
            <button onclick="startGame()" class="bg-cyan-500 hover:bg-cyan-400 text-slate-900 px-10 py-4 rounded-full text-xl font-bold transition-all hover:scale-105 shadow-lg shadow-cyan-500/50">
                ğŸš€ é–‹å§‹ä»»å‹™
            </button>
        </div>

        <div id="game-playing" class="hidden grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div id="balloon-stage" class="lg:col-span-2 relative bg-slate-800 h-[500px] rounded-3xl border-4 border-slate-700 overflow-hidden">
                </div>

            <div id="question-panel" class="bg-slate-800 p-6 rounded-3xl border border-slate-700 shadow-xl min-h-[400px]">
                <div id="panel-empty" class="h-full flex flex-col items-center justify-center text-slate-500 space-y-4">
                    <p class="font-bold text-center">è«‹é»æ“Šå·¦å´æ°£çƒ<br/>é–‹å§‹ä½œç­”</p>
                </div>
                <div id="panel-content" class="hidden space-y-6">
                    </div>
            </div>
        </div>

        <div id="game-end-overlay" class="hidden fixed inset-0 z-[100] bg-slate-900/95 backdrop-blur-sm flex items-center justify-center p-6">
            <div class="max-w-sm w-full bg-slate-800 p-10 rounded-3xl border-2 border-slate-700 text-center shadow-2xl">
                <div id="end-icon" class="text-7xl mb-6"></div>
                <h2 id="end-title" class="text-3xl font-black mb-2"></h2>
                <p class="text-slate-400 mb-8 text-xl">æœ€çµ‚å¾—åˆ†ï¼š<span id="final-score" class="text-yellow-400 font-bold"></span></p>
                <button onclick="startGame()" class="w-full py-4 bg-cyan-500 text-slate-900 font-black rounded-2xl hover:bg-cyan-400 transition-all hover:scale-105 shadow-lg">
                    ğŸ”„ å†è©¦ä¸€æ¬¡
                </button>
            </div>
        </div>
    </main>

    <script>
        const INITIAL_LIVES = 6;
        const questions = [
            { id: 1, question: 'é ­é ¸ç™Œé€²è¡ŒåŒ–å­¸æ²»ç™‚çš„ä¸»è¦ç›®çš„ç‚ºä½•ï¼Ÿ', options: ['A. æ¸›å°‘è…«ç˜¤é«”ç©', 'B. æ§åˆ¶è…«ç˜¤é€²å±•', 'C. ç·©è§£ç—‡ç‹€', 'D. ä»¥ä¸Šçš†æ˜¯'], correctAnswer: 'D. ä»¥ä¸Šçš†æ˜¯' },
            { id: 2, question: 'è£ç½®å‘¨é‚Šå°ç®¡æˆ–äººå·¥è¡€ç®¡ä¹‹æ‰‹è‡‚æ´»å‹•ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ', options: ['A. å¯è‡ªç”±é€²è¡Œ 360 åº¦æ—‹è½‰é‹å‹•', 'B. æ‡‰é¿å…å¤§ç¯„åœæ—‹è½‰èˆ‡éåº¦ç”¨åŠ›ï¼Œä¿æŒä¹¾ç‡¥', 'C. æ³¨å°„éƒ¨ä½å¯ä¿æŒæ½®æ¿•', 'D. æ‰‹è‡‚æ´»å‹•ä¸å—é™åˆ¶'], correctAnswer: 'B. æ‡‰é¿å…å¤§ç¯„åœæ—‹è½‰èˆ‡éåº¦ç”¨åŠ›ï¼Œä¿æŒä¹¾ç‡¥' },
            { id: 3, question: 'é—œæ–¼åŒ–å­¸æ²»ç™‚å‰é é˜²æ€§ç”¨è—¥èˆ‡è¡›æ•™ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ', options: ['A. å˜”åå¾Œå†çµ¦äºˆè—¥ç‰©å³å¯', 'B. æ‡‰ä¸»å‹•å‘é†«ç™‚äººå“¡è©¢å•è—¥ç‰©æ³¨æ„äº‹é …', 'C. åƒ…æœƒå¼•èµ·æ€¥æ€§å˜”å', 'D. å»¶é²æ€§åæ‡‰é€šå¸¸åœ¨ 1 å°æ™‚å…§ç™¼ç”Ÿ'], correctAnswer: 'B. æ‡‰ä¸»å‹•å‘é†«ç™‚äººå“¡è©¢å•è—¥ç‰©æ³¨æ„äº‹é …' },
            { id: 4, question: 'é—œæ–¼åŒ–å­¸æ²»ç™‚æœŸé–“çš„é£²é£Ÿæ³¨æ„äº‹é …ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ', options: ['A. åŒ–ç™‚å‰æ‡‰å¤§é‡é€²é£Ÿå¢åŠ é«”åŠ›', 'B. å‰1â€“2å°æ™‚é¿å…é€²é£Ÿï¼Œæ¡å°‘é‡å¤šé¤è»Ÿè³ªé£Ÿç‰©', 'C. å¯å¤šé£Ÿç”¨è¾›è¾£ã€æ²¹ç‚¸é£Ÿç‰©', 'D. é©é‡é£²é…’æœ‰åŠ©æ–¼æ¸›è¼•å™å¿ƒ'], correctAnswer: 'B. å‰1â€“2å°æ™‚é¿å…é€²é£Ÿï¼Œæ¡å°‘é‡å¤šé¤è»Ÿè³ªé£Ÿç‰©' },
            { id: 5, question: 'é—œæ–¼åŒ–ç™‚å¼•èµ·ä¹‹å£è…”ç‚ï¼é»è†œç‚çš„ç…§è­·ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ', options: ['A. ä½¿ç”¨ç¡¬æ¯›ç‰™åˆ·åŠ å¼·æ¸…æ½”', 'B. å¯ä½¿ç”¨å«é…’ç²¾æ¼±å£æ°´', 'C. ç¢ºè¨ºè€…æ‡‰æŒçºŒè­·ç†ï¼Œå†°æ°´å¯ç·©è§£ä¸é©', 'D. æ‡‰æ¸›å°‘æ¼±å£æ¬¡æ•¸'], correctAnswer: 'C. ç¢ºè¨ºè€…æ‡‰æŒçºŒè­·ç†ï¼Œå†°æ°´å¯ç·©è§£ä¸é©' },
            { id: 6, question: 'ç¬¬ä¸€æ¬¡æ¥å—åŒ–å­¸æ²»ç™‚å¾Œçš„ä¸è‰¯åæ‡‰è™•ç†ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ', options: ['A. å¤šå¯è‡ªè¡Œç·©è§£ç„¡é ˆå›å ±', 'B. é†«å¸«æ²’å®åš€å°±ç„¡é ˆæ³¨æ„', 'C. æ‡‰ä¸»å‹•å›è¨ºå‘ŠçŸ¥é†«å¸«æˆ–è¯ç¹«å€‹ç®¡å¸«', 'D. ç—‡ç‹€åš´é‡åˆ°ç„¡æ³•ç”Ÿæ´»æ‰éœ€è™•ç†'], correctAnswer: 'C. æ‡‰ä¸»å‹•å›è¨ºå‘ŠçŸ¥é†«å¸«æˆ–è¯ç¹«å€‹ç®¡å¸«' },
            { id: 7, question: 'é—œæ–¼ç™½è¡€çƒéä½æ™‚çš„ç”Ÿæ´»æ³¨æ„äº‹é …ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ', options: ['A. å¯æ­£å¸¸å¤–å‡ºäººå¤šå ´æ‰€', 'B. æ‡‰å‹¤æ´—æ‰‹ä¸¦é…æˆ´å£ç½©', 'C. åƒ…éœ€æ³¨æ„é£²é£Ÿï¼Œæ´»å‹•ä¸é™', 'D. å¯é€²è¡Œæ¿€çƒˆé‹å‹•'], correctAnswer: 'B. æ‡‰å‹¤æ´—æ‰‹ä¸¦é…æˆ´å£ç½©' },
            { id: 8, question: 'é—œæ–¼ç™½è¡€çƒéä½æ™‚å»ºè­°æ”å–çš„é£Ÿç‰©ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ', options: ['A. ç”Ÿé£Ÿè”¬æœèˆ‡æœªç†Ÿè›‹é¡', 'B. é«˜è›‹ç™½ã€å …æœåŠå¯Œå«ç¶­ç”Ÿç´  B12 é£Ÿç‰©', 'C. é«˜ç³–ç”œé£Ÿå¿«é€Ÿè£œå……ç†±é‡', 'D. é†ƒæ¼¬ã€åŠ å·¥é£Ÿå“'], correctAnswer: 'B. é«˜è›‹ç™½ã€å …æœåŠå¯Œå«ç¶­ç”Ÿç´  B12 é£Ÿç‰©' },
            { id: 9, question: 'é—œæ–¼æ”¾å°„æ²»ç™‚çš„ç‰¹æ€§èˆ‡ä¸è‰¯åæ‡‰ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ', options: ['A. ç©¿é€åŠ›å¼±åƒ…å½±éŸ¿è¡¨å±¤', 'B. å¸¸è¦‹ä¸è‰¯åæ‡‰åŒ…æ‹¬çš®è†šç‚ã€å‘³è¦ºæ”¹è®Š', 'C. ä¸æœƒå½±éŸ¿å£è…”èˆ‡ååš¥', 'D. å‡ºç¾æ°´æ³¡å±¬æ­£å¸¸ç„¡é ˆè™•ç†'], correctAnswer: 'B. å¸¸è¦‹ä¸è‰¯åæ‡‰åŒ…æ‹¬çš®è†šç‚ã€å‘³è¦ºæ”¹è®Š' },
            { id: 10, question: 'é—œæ–¼åŒ–/æ”¾ç™‚å¾Œçš®è†šåæ‡‰çš„ç…§è­·ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ', options: ['A. ç©¿è‘—è²¼èº«ç·Šèº«è¡£ç‰©', 'B. ä½¿ç”¨ç†±æ°´æ´—æ¾¡ä¿ƒé€²å¾ªç’°', 'C. ä½¿ç”¨ pH 5 ä¸­æ€§è‚¥çš‚ä¸¦ä»¥æº«æ°´æ¸…æ½”', 'D. ä¸éœ€é˜²æ›¬'], correctAnswer: 'C. ä½¿ç”¨ pH 5 ä¸­æ€§è‚¥çš‚ä¸¦ä»¥æº«æ°´æ¸…æ½”' }
        ];

        const balloonColors = ['from-pink-500 to-rose-600', 'from-cyan-500 to-blue-600', 'from-emerald-500 to-teal-600', 'from-amber-500 to-orange-600', 'from-violet-500 to-purple-600'];

        let score = 0;
        let lives = INITIAL_LIVES;
        let balloons = [];
        let answeredIds = new Set();
        let selectedBalloonId = null;
        let gameActive = false;
        let gameLoop;

        function startGame() {
            score = 0;
            lives = INITIAL_LIVES;
            balloons = [];
            answeredIds = new Set();
            selectedBalloonId = null;
            gameActive = true;
            
            document.getElementById('game-menu').classList.add('hidden');
            document.getElementById('game-end-overlay').classList.add('hidden');
            document.getElementById('game-playing').classList.remove('hidden');
            document.getElementById('stats-container').classList.remove('hidden');
            
            updateUI();
            
            if(gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(updateGame, 30);
        }

        function updateGame() {
            if (!gameActive) return;

            // Move balloons
            balloons.forEach((b, index) => {
                b.y += b.speed;
                if (b.y > 110) {
                    lives--;
                    balloons.splice(index, 1);
                    if (selectedBalloonId === b.id) deselectBalloon();
                    updateUI();
                }
            });

            // Spawn balloons
            if (Math.random() < 0.015 && balloons.length < 3 && answeredIds.size + balloons.length < questions.length) {
                spawnBalloon();
            }

            // Check game over
            if (lives <= 0) endGame('gameover');
            if (answeredIds.size === questions.length) endGame('victory');

            renderBalloons();
        }

        function spawnBalloon() {
            const unanswered = questions.filter(q => !answeredIds.has(q.id) && !balloons.some(b => b.questionId === q.id));
            if (unanswered.length === 0) return;

            const question = unanswered[Math.floor(Math.random() * unanswered.length)];
            const newBalloon = {
                id: Date.now() + Math.random(),
                questionId: question.id,
                question: question,
                color: balloonColors[Math.floor(Math.random() * balloonColors.length)],
                x: 10 + Math.random() * 75,
                y: -10,
                speed: 0.08 + Math.random() * 0.05
            };
            balloons.push(newBalloon);
        }

        function renderBalloons() {
            const stage = document.getElementById('balloon-stage');
            // æˆ‘å€‘åªæ›´æ–°ä½ç½®ï¼Œä¸é »ç¹é‡å»º DOM ä»¥ä¿æŒæ•ˆèƒ½
            balloons.forEach(b => {
                let el = document.getElementById(`balloon-${b.id}`);
                if (!el) {
                    el = document.createElement('div');
                    el.id = `balloon-${b.id}`;
                    el.className = `absolute cursor-pointer transition-transform duration-300 hover:scale-110`;
                    el.innerHTML = `
                        <div class="w-16 h-16 bg-gradient-to-br ${b.color} rounded-full shadow-2xl flex items-center justify-center border-2 border-white/30 relative">
                            <div class="absolute top-2 left-2 w-3 h-3 bg-white/30 rounded-full"></div>
                            <div id="ping-${b.id}" class="hidden absolute -inset-2 border-4 border-yellow-400 rounded-full animate-ping-custom"></div>
                        </div>
                        <div class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-b-[8px] border-b-slate-400 mx-auto -mt-1"></div>
                        <div class="w-0.5 h-10 bg-slate-500 mx-auto"></div>
                    `;
                    el.onclick = () => selectBalloon(b);
                    stage.appendChild(el);
                }
                el.style.left = `${b.x}%`;
                el.style.bottom = `${b.y}%`;
                
                // Highlight selected
                const ping = document.getElementById(`ping-${b.id}`);
                if (selectedBalloonId === b.id) {
                    ping.classList.remove('hidden');
                    el.classList.add('scale-125', 'z-30');
                } else {
                    ping.classList.add('hidden');
                    el.classList.remove('scale-125', 'z-30');
                }
            });

            // Remove non-existent balloons from DOM
            const allElements = stage.querySelectorAll('[id^="balloon-"]');
            allElements.forEach(el => {
                const id = parseFloat(el.id.replace('balloon-', ''));
                if (!balloons.find(b => b.id === id)) el.remove();
            });
        }

        function selectBalloon(balloon) {
            selectedBalloonId = balloon.id;
            const panelEmpty = document.getElementById('panel-empty');
            const panelContent = document.getElementById('panel-content');
            
            panelEmpty.classList.add('hidden');
            panelContent.classList.remove('hidden');
            
            panelContent.innerHTML = `
                <div>
                    <div class="inline-block bg-cyan-500 text-slate-900 px-3 py-1 rounded-md text-sm font-bold mb-3">
                        é¡Œç›® ${balloon.question.id}/${questions.length}
                    </div>
                    <div class="bg-slate-700 p-4 rounded-xl">
                        <p class="text-lg font-bold leading-relaxed">${balloon.question.question}</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 gap-3">
                    ${balloon.question.options.map(opt => `
                        <button onclick="handleAnswer('${opt.replace(/'/g, "\\'")}')" class="option-btn text-left p-4 rounded-xl border-2 border-slate-600 hover:border-cyan-500 hover:bg-slate-700 transition-all font-semibold">
                            ${opt}
                        </button>
                    `).join('')}
                </div>
                <div id="feedback" class="hidden p-4 rounded-xl text-center font-bold"></div>
            `;
        }

        function deselectBalloon() {
            selectedBalloonId = null;
            document.getElementById('panel-empty').classList.remove('hidden');
            document.getElementById('panel-content').classList.add('hidden');
        }

        function handleAnswer(selectedOption) {
            const balloon = balloons.find(b => b.id === selectedBalloonId);
            if (!balloon) return;

            const feedbackEl = document.getElementById('feedback');
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => btn.disabled = true);

            if (selectedOption === balloon.question.correctAnswer) {
                score += 10;
                answeredIds.add(balloon.questionId);
                feedbackEl.innerHTML = "âœ¨ æ­£ç¢ºæ“Šç ´ï¼";
                feedbackEl.className = "p-4 rounded-xl text-center font-bold bg-green-500/20 text-green-400 border-2 border-green-500 block";
                
                setTimeout(() => {
                    balloons = balloons.filter(b => b.id !== balloon.id);
                    deselectBalloon();
                    updateUI();
                }, 1000);
            } else {
                lives--;
                feedbackEl.innerHTML = "âŒ ç­”éŒ¯äº†ï¼Œç”Ÿå‘½å€¼ä¸‹é™";
                feedbackEl.className = "p-4 rounded-xl text-center font-bold bg-rose-500/20 text-rose-400 border-2 border-rose-500 block";
                
                setTimeout(() => {
                    feedbackEl.classList.add('hidden');
                    buttons.forEach(btn => btn.disabled = false);
                    updateUI();
                }, 1000);
            }
        }

        function updateUI() {
            document.getElementById('score-display').innerText = score;
            const livesEl = document.getElementById('lives-display');
            livesEl.innerHTML = '';
            for (let i = 0; i < INITIAL_LIVES; i++) {
                livesEl.innerHTML += i < lives ? 'â¤ï¸' : 'ğŸ–¤';
            }
        }

        function endGame(type) {
            gameActive = false;
            clearInterval(gameLoop);
            
            const overlay = document.getElementById('game-end-overlay');
            const icon = document.getElementById('end-icon');
            const title = document.getElementById('end-title');
            const finalScore = document.getElementById('final-score');
            
            overlay.classList.remove('hidden');
            finalScore.innerText = score;
            
            if (type === 'victory') {
                icon.innerText = 'ğŸ†';
                title.innerText = 'å¤§ç²å…¨å‹ï¼';
            } else {
                icon.innerText = 'ğŸ’€';
                title.innerText = 'ä»»å‹™å¤±æ•—';
            }
        }
    </script>
</body>

</html>
